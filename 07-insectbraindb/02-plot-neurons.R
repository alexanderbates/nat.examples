## This script assumed that you have run the file "07-insectbraindb/00-setup.R"

## First, we call the read neurons function, with ids set to NULL
insect.neurons = insectbraindb_read_neurons(ids = NULL)

## So, it seem the Monarch Butterfly is the clear winner there, 
## maybe let's just have those
butterfly.neurons = subset(insect.neurons, common_name == "Monarch Butterfly")

## And let's plot them
nat::nopen3d(userMatrix = structure(c(0.998683869838715, -0.00999264605343342, 
                                      -0.050302866846323, 0, -0.0184538997709751, -0.985155284404755, 
                                      -0.170669943094254, 0, -0.0478506684303284, 0.171373650431633, 
                                      -0.984043300151825, 0, 0, 0, 0, 1), .Dim = c(4L, 4L)), zoom = 0.600000023841858, 
             windowRect = c(1440L, 45L, 3209L, 1063L))
plot3d(butterfly.neurons, lwd = 2, soma = 5)

## Cool! But maybe we also want to see it's template brain? 
## Let's check if they have it
available.brains = insectbraindb_species_info()
available.brains

## Great, they do, let's get it
butterfly.brain = insectbraindb_read_brain(species = "Danaus plexippus")

## And plot in a translucent manner
plot3d(butterfly.brain, alpha = 0.1)
rgl.snapshot(file = paste0("images/MonarchButterly_ReppertLab_.png"), fmt = "png")

## Oop, that's a lot of neuropils. 
## Let's go for only a subset. What's available?
butterfly.brain$RegionList
butterfly.brain$neuropil_full_names

## There lateral horn (LH) and the antennal lobe (AL) are my favourites.
## Let's plot those
clear3d()
plot3d(subset(butterfly.brain, "LH|AL"), alpha = 0.5)
plot3d(butterfly.neurons, lwd = 2, soma = 5)
